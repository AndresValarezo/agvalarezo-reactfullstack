<!DOCTYPE html>
<html lang="en" >
   <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Api Rest</title> 
   </head>
   <body>
       <div>
            <label> Marca: </label>
            <input type="text"  id="umarca" placeholder="Marca">
       </div>
       <div>
            <label> Model: </label>
            <input type="text"  id="umodel" placeholder="Model">
       </div>
       <br>
       <button type="button" id = "buttonUpdateCar" > Update </button>

       <script>
           
            window.addEventListener("DOMContentLoaded",_=>{
                document.querySelector("#buttonUpdateCar")
                    .addEventListener("click",updateCar)

                showCar();
            });

            async function showCar(_) {
                const url = new URL(window.location.href);
                const carId = parseInt(url.searchParams.get('car'));

                const result = await fetch(
                    `http://localhost:5000/api/cars/${carId}` 
                );
                const dates = await result.json();
                umarca.value = dates.result.marca;
                umodel.value = dates.result.model;


            }
            async function updateCar() {
                const url = new URL(window.location.href);
                const carId = parseInt(url.searchParams.get('car'));
                const car= {
                    id: carId,
                    marca: umarca.value,
                    model: umodel.value
                }
            

                const result = await fetch(
                'http://localhost:5000/api/cars',
                {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                    },
                    body: JSON.stringify(car)
                }
                );
                const dates = await result.json();
                if(dates.ok)
                {
                    window.location= './showCars.html';
                }
            }
       </script>
   </body>


</html>